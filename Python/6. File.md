## 파일 읽고 쓰기



### 파일 생성하기

```python
f = open('new.txt', 'w')
f.close()
```

파일을 생성하기 위해 파이썬 내장 함수 open을 사용한다. open 함수는 다음과 같이 "파일 이름"과 "파일 열기 모드"를 입력값으로 받고 결괏값으로 파일 객체를 돌려준다. 파일 열기모드에는 다양한 옵션이 존재한다.

| 파일 열기 모드 | 설명                                                         |
| -------------- | ------------------------------------------------------------ |
| w              | 쓰기 모드 - 파일에 내용을 쓸 때 사용                         |
| r              | 읽기 모드 - 파일을 읽기만 할 때 사용                         |
| a              | 추가 모드 - 파일의 마지막에 새로운 내용을 이어서 추가 할 때 사용 |

파일을 쓰기 모드로 열면 해당 파일이 이미 존재할 경우 원래 있던 내용이 모두 지우고 새로운 내용을 적는다. 해당 파일이 존재하지 않으면 새로운 파일이 생성하여 내용을 쓴다. `f.close()`는 열려 있는 파일 객체를 닫아 주는 역할을 한다. 프로그램을 종료할 때 파이썬 프로그램이 열려 있는 파일의 객체를 자동으로 닫아주기 때문에 쓰지 않아도 문제가 없지만 `close()`를 사용해서 열려 있는 파일을 직접 닫아 주는 것이 좋다. 쓰기모드로 열었던 파일을 닫지 않고 다시 사용하려고 하면 오류가 발생한다.



### 파일을 쓰기 모드로 열어 출력값 적기

위에서 파일을 쓰기 모드로 열기만 했다. 이 파일에 우리가 원하는 값을 입력해보자.

```python
f = open("test_file.txt", 'w')
for i in range(1, 11):
    data = "%d번째 줄입니다.\n" % i
    f.write(data)
f.close()
```

위 프로그램을 다음 프로그램과 비교해 보자.

```python
for i in range(1, 11):
    data = "%d번째 줄입니다.\n" % i
    print(data)
```

두 코드의 다른 점은 data를 출력하는 방법이다. 두 번째 방법은 우리가 계속 사용해 왔던 모니터 화면에 출력하는 방법이고, 첫 번째 방법은 파일에 결과값을 적는 저장하는 방법이다. 두 방법의 차이점은 print 대신 파일 객체 f의 write 함수를 사용한 것 말고는 큰 차이가 없다.



### 프로그램의 외부에 저장된 파일을 읽는 여러 가지 방법

파이썬에는 외부 파일을 읽어 들여 프로그램에서 사용할 수 있는 여러 가지 방법이 있다. 

#### readline() 함수 이용하기

첫 번째 방법은 readline 함수를 사용하는 방법이다. 다음 예를 보자.

```python
f = open("test_file.txt", 'r')
line = f.readline()
print(line)
f.close()
```

위 예는 `f.open("file", 'r')`로 파일을 읽기 모드로 연 후 `readline()`을 사용해서 파일의 첫 번째 줄을 읽어 출력하는 경우이다. 앞에서 만든 `test_file.txt`를 수정하거나 지우지 않았다면 위 프로그램을 실행했을 때 `test_file.txt`의 가장 첫 번째 줄이 화면에 출력될 것이다.

```
1번째 줄입니다.
```

만약 모든 줄을 읽어서 화면에 출력하고 싶다면 다음과 같이 작성하면 된다.

```python
f = open("test_file.txt", 'r')
while True:
    line = f.readline()
    if not line: break
    print(line)
f.close()
```

즉 `while True:` 무한 루프 안에서 `f.readline()`을 사용해 파일을 계속해서 한 줄씩 읽어 들인다. 만약 더 이상 읽을 줄이 없으면 break를 수행한다(`readline()`은 더 이상 읽을 줄이 없을 경우 None을 출력한다).

앞의 프로그램을 다음 프로그램과 비교해 보자.

```python
while 1:
    data = input()
    if not data: break
    print(data)
```

위 예는 사용자의 입력을 받아서 그 내용을 출력하는 경우이다. 파일을 읽어서 출력하는 예제와 비교해 보자. 입력을 받는 방식만 다르다는 것을 바로 알 수 있을 것이다. 두 번째 예는 키보드를 사용한 입력 방법이고, 첫 번째 예는 파일을 사용한 입력 방법이다.



#### readlines 함수 사용하기

두 번째 방법은 readlines 함수를 사용하는 방법이다. 다음 예를 보자.

```python
f = open("test_file.txt", 'r')
lines = f.readlines()
for line in lines:
    print(line)
f.close()
```

readlines 함수는 파일의 모든 줄을 읽어서 각각의 줄을 요소로 갖는 리스트로 돌려준다. 따라서 위 예에서 lines는 리스트 `["1 번째 줄입니다.", "2 번째 줄입니다.", ..., "10 번째 줄입니다."]`가 된다. `f.readlines()`에서 `f.readline()`과는 달리 s가 하나 더 붙어 있음에 유의하자.



#### read 함수 사용하기

세 번째 방법은 read 함수를 사용하는 방법이다. 다음 예를 보자.

```python
f = open("test_file.txt", 'r')
data = f.read()
print(data)
f.close()
```

`f.read()`는 파일의 내용 전체를 문자열로 돌려준다. 따라서 위 예의 data는 파일의 전체 내용이다.



## 파일에 새로운 내용 추가하기

쓰기 모드('w')로 파일을 열 때 이미 존재하는 파일을 열면 그 파일의 내용이 모두 사라진다. 하지만 원래 있던 값을 유지하면서 단지 새로운 값만 추가해야 할 경우도 있다. 이런 경우에는 파일을 추가 모드('a')로 열면 된다. 

```python
f = open("test_file.txt",'a')
for i in range(11, 20):
    data = "%d번째 줄입니다.\n" % i
    f.write(data)
f.close()
```

위 예는 `test_file.txt` 파일을 추가 모드('a')로 열고 write를 사용해서 결과값을 기존 파일에 추가해 적는 예이다. 여기에서 추가 모드로 파일을 열었기 때문에  `test_file.txt`파일이 원래 가지고 있던 내용 바로 다음부터 값을 적기 시작한다. 파일을 열어 보면 11번째 줄입니다. 부터 19번째 줄입니다 까지 추가되어 있을 것이다.



### with문과 함께 사용하기

지금까지 파일을 수동으로 닫았다. 

```python
f = open("foo.txt", 'w')
f.write("Life is too short, you need python")
f.close()
```

파일을 열면 위와 같이 항상 close해 주는 것이 좋다. 하지만 이렇게 파일을 열고 닫는 것을 자동으로 처리할 수 있다면 편리하지 않을까? 파이썬의 with문이 바로 이런 역할을 해준다. 다음 예는 with문을 사용해서 위 예제를 다시 작성한 모습이다.

```python
with open("foo.txt", "w") as f:
    f.write("Life is too short, you need python")
```

위와 같이 with문을 사용하면 with 블록을 벗어나는 순간 열린 파일 객체 f가 자동으로 close되어 편리하다.